---
layout: post
title: yolov8训练自定义数据
date: 2023-11-12 19:43 +0800
excerpt: '用yolov8训练自定义数据集做道路坑洼检测'
---
[UltraLytics YOLOv8]是Ultralytics出品的最新YOLO实现。这个版本和前面的几个版本代码是不一样的，是重写的。 [github Repo](https://github.com/ultralytics/ultralytics)首页有YOLOv8和前几个版本的性能对比(COCO mAP, Mean Average Precision), 可以看出V8速度更快，精读更高。

[YOLOv8官方文档](https://docs.ultralytics.com/#where-to-start)非常完善，入门直接用它的官方文档就够了。

YOLOv8包含以下功能:
1. Detection, 目标检测, 检测目标类型。
2. Segmentation, 图像分割，生成掩码，把目标对象标的范围记出来。
3. Pose estimation,手势预测。
4. Tracking, 移动目标跟踪.
5. Classification,分类.

YOLOv8能做推理，还能自己训练自定义数据模型。

我想做的是路面缺陷检测(坑洼), 属于目标检测范畴.用私有数据训练模型，然后做检测。

我自己没有准备数据，所以找了网上的一个教程，那个教程有提供一套数据: 
1. 教程: https://learnopencv.com/train-yolov8-on-custom-dataset/
2. 自定义数据集: https://www.dropbox.com/s/qvglw8pqo16769f/pothole_dataset_v8.zip
3. 环境: ubuntu 2022.04, [anaconda 2023.09](https://repo.anaconda.com/archive/Anaconda3-2023.09-0-Linux-x86_64.sh)

Ultralytics官方文档里面有提到[YOLOv6](https://github.com/meituan/YOLOv6)由美团出品，这个倒是有点意外。

# 步骤
   
1. 下载数据集: `wget https://www.dropbox.com/s/qvglw8pqo16769f/pothole_dataset_v8.zip?dl=1 -O pothole_dataset_v8.zip`
2. 解压数据集: `unzip pothole_dataset_v8.zip`
3. 下载anaconda: `wget https://repo.anaconda.com/archive/Anaconda3-2023.09-0-Linux-x86_64.sh`
4. 安装anaconda: `chmod +x Anaconda3-2023.09-0-Linux-x86_64.sh && ./Anaconda3-2023.09-0-Linux-x86_64.sh`
5. 安装完anaconda后退出shell, 重新进入.
6. 安装yolov8: `pip install ultralytics`
7. 先训练nano模型, 我跑在CPU上，所以会比较慢: 
   1. 配置参数`pothole_v8.yaml`:
      ~~~yaml
        path: pothole_dataset_v8/
        train: 'train/images'
        val: 'valid/images'
        
        # class names
        names: 
        0: 'pothole'
      ~~~
   2. 运行命令行: `yolo task=detect mode=train model=yolov8n.pt imgsz=1280 data=pothole_v8.yaml epochs=50 batch=8 name=yolov8n_v8_50e`
      1. 参数详解: 
   3. AMD EPYC 7763, 8核心
   4. 32GB内存, 512GB SSD
   5. 跑nano,一个晚上, 10个小时左右，跑了7个epoch。24小时跑了13个epoch，跑完50个epoch看来需要4天了。


# 性能数据
